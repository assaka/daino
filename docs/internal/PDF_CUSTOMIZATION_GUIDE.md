# PDF Customization Guide

This guide explains how to customize the PDF layouts for invoices and shipments in your e-commerce platform.

## üìç Location

PDF templates are defined in: **`backend/src/services/pdf-service.js`**

## üé® Customizing PDF Layouts

### Invoice PDF Template

The invoice PDF is generated by the `generateInvoicePDF()` method. To customize:

1. **Open** `backend/src/services/pdf-service.js`
2. **Find** the `generateInvoicePDF()` method (around line 65)
3. **Modify** the HTML template inside the function

**Key Areas to Customize:**

```javascript
// Header Section (line ~90)
generatePDFHeader(store, 'invoice')

// Company Logo & Info
<img src="${logoUrl}" alt="${storeName}" style="...">
<h1>${storeName}</h1>

// Invoice Details Table (line ~110)
<table>
  <tr>
    <td>Invoice #:</td>
    <td>${order.order_number}</td>
  </tr>
</table>

// Items Table (line ~140)
<table>
  <thead>
    <tr>
      <th>Item</th>
      <th>Qty</th>
      <th>Price</th>
      <th>Total</th>
    </tr>
  </thead>
</table>

// Totals Section (line ~180)
<div class="total-section">
  <table>
    <tr>
      <td>Subtotal:</td>
      <td>$${order.subtotal}</td>
    </tr>
    <!-- Add custom fees here -->
  </table>
</div>

// Footer Section (line ~200)
generatePDFFooter(store)
```

### Shipment PDF Template

The shipment PDF is generated by the `generateShipmentPDF()` method.

1. **Open** `backend/src/services/pdf-service.js`
2. **Find** the `generateShipmentPDF()` method (around line 230)
3. **Modify** the HTML template inside the function

**Key Areas to Customize:**

```javascript
// Tracking Info Box (line ~270)
<div class="tracking-section">
  <h3>Tracking Information</h3>
  <p style="font-size: 24px;">${order.tracking_number}</p>
</div>

// Package Contents Table (line ~300)
<table>
  <thead>
    <tr>
      <th>Item</th>
      <th>Qty</th>
      <th>SKU</th>
    </tr>
  </thead>
</table>

// Delivery Instructions (line ~330)
<div style="background-color: #fef3c7;">
  <p>${order.delivery_instructions}</p>
</div>
```

### PDF Header Customization

**Method:** `generatePDFHeader(store, type)` (line ~25)

Customize:
- Logo size and positioning
- Company name styling
- Address format
- Border colors

```javascript
generatePDFHeader(store, type = 'invoice') {
  return `
    <div style="text-align: center; border-bottom: 3px solid #4f46e5;">
      ${logoUrl ? `<img src="${logoUrl}" style="max-width: 150px;">` : ''}
      <h1 style="font-size: 28px;">${storeName}</h1>
      <p>${store.address_line1}<br>${store.city}, ${store.state}</p>
    </div>
  `;
}
```

### PDF Footer Customization

**Method:** `generatePDFFooter(store)` (line ~50)

Customize:
- Footer text and styling
- Copyright information
- Social media links
- Terms and conditions

```javascript
generatePDFFooter(store) {
  return `
    <div style="margin-top: 50px; text-align: center; color: #9ca3af;">
      <p>Thank you for your business!</p>
      <p>${store.name} | ${store.contact_email}</p>
      <p>¬© ${currentYear} ${store.name}. All rights reserved.</p>
    </div>
  `;
}
```

## üé® Styling Tips

### Colors

Default color scheme:
- Primary: `#4f46e5` (Indigo)
- Success: `#10b981` (Green)
- Warning: `#fef3c7` (Yellow)
- Background: `#f9fafb` (Light Gray)

**To change colors globally**, search and replace in the method:
```javascript
// Change primary color from blue to your brand color
'#4f46e5' ‚Üí '#your-brand-color'
```

### Fonts

Default font: `'Helvetica', 'Arial', sans-serif`

**To change fonts:**
```javascript
body {
  font-family: 'Your-Font-Name', 'Fallback-Font', sans-serif;
}
```

### Layout

- Page format: `A4` (configurable in constructor)
- Margins: `20px` all sides (configurable in constructor)
- Max width: `800px` for content

**To change page settings:**
```javascript
constructor() {
  this.options = {
    format: 'Letter',  // Change from A4 to Letter
    margin: {
      top: '30px',     // Increase margins
      right: '30px',
      bottom: '30px',
      left: '30px'
    }
  };
}
```

## üìù Adding Custom Fields

### Example: Add "Due Date" to Invoice

1. **Add the field to the template:**

```javascript
// In generateInvoicePDF(), around line 120
<tr>
  <td style="padding: 5px 0;"><strong>Due Date:</strong></td>
  <td style="padding: 5px 0; text-align: right;">{{due_date}}</td>
</tr>
```

2. **Pass the value when generating PDF:**

```javascript
// When calling generateInvoicePDF()
const dueDate = new Date(order.created_at);
dueDate.setDate(dueDate.getDate() + 30); // 30 days from invoice date

// The template will automatically include it
```

### Example: Add Company Registration Number

```javascript
// In generatePDFFooter()
<p style="font-size: 11px;">
  ${store.name} | Reg. No: ${store.registration_number || 'N/A'}<br>
  VAT No: ${store.vat_number || 'N/A'}
</p>
```

## üñºÔ∏è Logo Customization

Logo is pulled from: `store.logo_url`

**Size constraints:**
- Max width: `150px` (invoice header)
- Max height: `80px` (invoice header)

**To change logo size:**
```javascript
<img src="${logoUrl}" style="max-width: 200px; max-height: 100px;">
```

## üìê Multi-Column Layouts

To add side-by-side content:

```javascript
<div style="display: flex; justify-content: space-between;">
  <div style="width: 48%;">
    <h3>Left Column</h3>
    <p>Content here</p>
  </div>
  <div style="width: 48%;">
    <h3>Right Column</h3>
    <p>Content here</p>
  </div>
</div>
```

## üåê Internationalization

For multi-language PDF support, you can use the order's language setting:

```javascript
async generateInvoicePDF(order, store, orderItems, language = 'en') {
  const labels = {
    en: { invoice: 'Invoice', total: 'Total' },
    nl: { invoice: 'Factuur', total: 'Totaal' },
    fr: { invoice: 'Facture', total: 'Total' }
  };

  const t = labels[language] || labels.en;

  // Use in template:
  <h2>${t.invoice} #${order.order_number}</h2>
}
```

## üîÑ Applying Changes

After modifying `pdf-service.js`:

1. **Save the file**
2. **Restart the backend server**
   ```bash
   cd backend
   npm run dev
   ```
3. **Test by triggering an invoice/shipment email**

**No database changes needed** - PDF templates are pure code!

## üìã Complete Example: Custom Invoice

```javascript
async generateInvoicePDF(order, store, orderItems) {
  const html = `
    <!DOCTYPE html>
    <html>
    <head>
      <style>
        body {
          font-family: 'Georgia', serif;
          color: #1a1a1a;
        }
        .container {
          max-width: 800px;
          margin: 0 auto;
          padding: 40px;
        }
        .header {
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          color: white;
          padding: 30px;
          text-align: center;
        }
        .invoice-number {
          font-size: 32px;
          font-weight: bold;
          color: #667eea;
        }
      </style>
    </head>
    <body>
      <div class="container">
        <div class="header">
          <h1>${store.name}</h1>
          <p>${store.tagline || 'Premium Products'}</p>
        </div>

        <div class="invoice-number">
          INVOICE #${order.order_number}
        </div>

        <!-- Your custom content here -->

      </div>
    </body>
    </html>
  `;

  const file = { content: html };
  return await htmlPdf.generatePdf(file, this.options);
}
```

## üí° Pro Tips

1. **Test with sample data** - Create test orders to preview changes
2. **Use inline CSS** - PDF generators work best with inline styles
3. **Keep it simple** - Complex layouts may not render correctly
4. **Check on different scales** - Test PDF output at 100%, 75%, and 50% zoom
5. **Print preview** - Always check how it looks when printed

## üÜò Need Help?

- Check the `html-pdf-node` documentation for advanced features
- Look at existing email templates in the database for HTML examples
- The `formatAddress()` helper function formats addresses nicely
- The `formatOrderItemsHtml()` helper creates item tables for emails

## üì¶ Related Files

- **PDF Service**: `backend/src/services/pdf-service.js`
- **Email Service**: `backend/src/services/email-service.js`
- **Email Templates**: Database table `email_templates`
- **Template Variables**: `backend/src/services/email-template-variables.js`
